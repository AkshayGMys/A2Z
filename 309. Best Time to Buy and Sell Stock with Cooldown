class Solution {
public:
   int f(int index , int canBuy , vector<int>& prices , vector<vector<int>>& dp)
    {
        if(index >= prices.size()) return 0;
        if(dp[index][canBuy] != -1) return dp[index][canBuy];
        int profit = 0 ;
        if(canBuy == 0)
        {
            int buy = f(index+1 , 1 , prices ,dp) -prices[index] ;
            int doNothing = f(index+1 , 0 , prices , dp);
            profit = max(buy , doNothing);
        }
        else if(canBuy == 1)
        {
            int sell = f(index+1 , 2 , prices ,dp) + prices[index];
            int doNothing = f(index+1 , 1 , prices , dp);
            profit = max(sell , doNothing);
        }
        else
            profit =  f(index+1 , 0 , prices , dp);
        return dp[index][canBuy]=profit;
    }
    //0 -> can Buy , 1->Can Sell ,2->Just Sold
    int maxProfit(vector<int>& prices) {
        int n = prices.size();
        vector<vector<int>> dp(n , vector<int>( 3, -1));
        return f( 0 , 0 , prices , dp);
    }
};
